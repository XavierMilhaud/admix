<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Two-samples hypothesis test on the unknown component in admixture models — two_samples_test • admix</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Two-samples hypothesis test on the unknown component in admixture models — two_samples_test"><meta property="og:description" content="Test hypothesis on the unknown component of admixture models using different estimation techniques, and different
testing strategies."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">admix</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1-0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/admixture-clustering.html">Clustering of unknown subpopulations in admixture models</a>
    </li>
    <li>
      <a href="../articles/admixture-weight-estimation.html">Estimation of unknown elements in admixture models</a>
    </li>
    <li>
      <a href="../articles/test-hypothesis.html">Hypothesis test in admixture models</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/XavierMilhaud/admix/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Two-samples hypothesis test on the unknown component in admixture models</h1>
    <small class="dont-index">Source: <a href="https://github.com/XavierMilhaud/admix/blob/HEAD/R/two_samples_test.R" class="external-link"><code>R/two_samples_test.R</code></a></small>
    <div class="hidden name"><code>two_samples_test.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Test hypothesis on the unknown component of admixture models using different estimation techniques, and different
testing strategies.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">two_samples_test</span><span class="op">(</span></span>
<span>  <span class="va">samples</span>,</span>
<span>  known.p <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  comp.dist <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  comp.param <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ICV"</span>, <span class="st">"Poly"</span><span class="op">)</span>,</span>
<span>  n_sim_tab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  K <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  support <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Real"</span>, <span class="st">"Positive"</span>, <span class="st">"Integer"</span>, <span class="st">"Bounded.continuous"</span><span class="op">)</span>,</span>
<span>  est.method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BVdk"</span>, <span class="st">"PS"</span><span class="op">)</span>,</span>
<span>  s <span class="op">=</span> <span class="fl">0.49</span>,</span>
<span>  nb.ssEch <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  var.explicit <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  nb.echBoot <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bounds.supp <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  n_cpu <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>samples</dt>
<dd><p>A list of the two observed samples, where each sample follows the mixture distribution given by l = p*f + (1-p)*g,
with f and p unknown and g known.</p></dd>


<dt>known.p</dt>
<dd><p>(default to NULL) The true component weights p1 and p2 if known, only useful in simulation studies.</p></dd>


<dt>comp.dist</dt>
<dd><p>A list with four elements corresponding to the component distributions (specified with R native names for these distributions)
involved in the two admixture models. The two first elements refer to the unknown and known components of the 1st admixture model,
and the last two ones to those of the second admixture model. If there are unknown elements, they must be specified as 'NULL' objects.
For instance, 'comp.dist' could be specified as follows: list(f1=NULL, g1='norm', f2=NULL, g2='norm').</p></dd>


<dt>comp.param</dt>
<dd><p>A list with four elements corresponding to the parameters of the component distributions, each element being a list
itself. The names used in this list must correspond to the native R argument names for these distributions.
The two first elements refer to the parameters of unknown and known components of the 1st admixture model, and the last
two ones to those of the second admixture model. If there are unknown elements, they must be specified as 'NULL' objects.
For instance, 'comp.param' could be specified as follows: : list(f1=NULL, g1=list(mean=0,sd=1), f2=NULL, g2=list(mean=3,sd=1.1)).</p></dd>


<dt>method</dt>
<dd><p>Method used for testing. Choose either 'Poly' or 'ICV'. 'Poly' refers to comparison of expansion coefficients in polynomial
orthonormal basis, whereas 'ICV' refers to the Inner Convergence property obtained when using the IBM approach.
More details are provided below in 'Details'.</p></dd>


<dt>n_sim_tab</dt>
<dd><p>(Only with 'ICV' method) Number of simulated gaussian processes used for the tabulation of the Inner Convergence distribution in IBM approach.</p></dd>


<dt>K</dt>
<dd><p>(Only for 'Poly' method) Number of coefficients considered for the polynomial basis expansion.</p></dd>


<dt>support</dt>
<dd><p>(Only for 'Poly' method) Support of the densities under consideration, useful to choose the polynomial orthonormal basis.
One of 'Real', 'Integer', 'Positive', or 'Bounded.continuous'.</p></dd>


<dt>est.method</dt>
<dd><p>(Only for 'Poly' method) Either 'BVdk' (Bordes and Valdekerkhove estimation technique) or 'PS' (Patra and Sen estimation
technique). The latter should not be used since the estimators plugged into the test statistic are not square-root n
consistent. More details are given in Section 'Details' below.</p></dd>


<dt>s</dt>
<dd><p>(Only for 'Poly' method) Rate at which the normalization factor is set in the penalization rule for model selection (in ]0,1/2[).</p></dd>


<dt>nb.ssEch</dt>
<dd><p>(Only with 'Poly' method) Number of subsamples created from original data to decorrelate the estimation of the parameters.</p></dd>


<dt>var.explicit</dt>
<dd><p>(Only with 'Poly' method) Boolean that enables to choose between explicit evaluation of the variance of the test
statistic or not (FALSE=bootstrap). FIXME: it seems that bootstrap procedure does not work in the context of admixtures.</p></dd>


<dt>nb.echBoot</dt>
<dd><p>(Only with 'Poly' method) Number of bootstrap samples if 'var.explicit' is set to FALSE.</p></dd>


<dt>bounds.supp</dt>
<dd><p>(Only with 'Poly' method) default to NULL. Useful if support = 'bounded.continuous', a list of minimum and maximum bounds,
specified as follows: list( list(min.f1,min.g1,min.f2,min.g2) , list(max.f1,max.g1,max.f2,max.g2) )</p></dd>


<dt>parallel</dt>
<dd><p>Boolean to indicate whether parallel computations are performed (speed-up the tabulation).</p></dd>


<dt>n_cpu</dt>
<dd><p>Number of cores used when parallelizing.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>The decision of the test with further information such as p-value and others, depending on the method used.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Here as some details concerning the different methods that can be choosen: i) 'Poly' relies on two-sample testing strategy
where each unknown component density is decomposed in an orthonormal polynomial basis, and the estimation of the component
weights related to the two two-component admixture models can be performed either using Patra and Sen estimator (despite
the latter is not square-root n consistent and thus should not be used in such hypothesis tests), or by Bordes and Vandekerkhove
estimation technique (if the unknown component density is symmetric); ii) 'ICV' refers to Inversion - Best Matching strategy
which has no constraints except that we need to handle two samples.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Xavier Milhaud <a href="mailto:xavier.milhaud.research@gmail.com">xavier.milhaud.research@gmail.com</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">##### Under the null hypothesis H0 :</span></span></span>
<span class="r-in"><span><span class="co">## Simulate data:</span></span></span>
<span class="r-in"><span><span class="va">list.comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>f1 <span class="op">=</span> <span class="st">"norm"</span>, g1 <span class="op">=</span> <span class="st">"norm"</span>,</span></span>
<span class="r-in"><span>                  f2 <span class="op">=</span> <span class="st">"norm"</span>, g2 <span class="op">=</span> <span class="st">"norm"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">list.param</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>f1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">3</span>, sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, g1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   f2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">3</span>, sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, g2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">6</span>, sd <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sample1</span> <span class="op">&lt;-</span> <span class="fu"><a href="rsimmix.html">rsimmix</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">250</span>, unknownComp_weight<span class="op">=</span><span class="fl">0.85</span>, comp.dist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">list.comp</span><span class="op">$</span><span class="va">f1</span>,<span class="va">list.comp</span><span class="op">$</span><span class="va">g1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   comp.param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">list.param</span><span class="op">$</span><span class="va">f1</span>,<span class="va">list.param</span><span class="op">$</span><span class="va">g1</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="st">'mixt.data'</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">sample2</span> <span class="op">&lt;-</span> <span class="fu"><a href="rsimmix.html">rsimmix</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">300</span>, unknownComp_weight<span class="op">=</span><span class="fl">0.8</span>, comp.dist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">list.comp</span><span class="op">$</span><span class="va">f2</span>,<span class="va">list.comp</span><span class="op">$</span><span class="va">g2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   comp.param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">list.param</span><span class="op">$</span><span class="va">f2</span>,<span class="va">list.param</span><span class="op">$</span><span class="va">g2</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="st">'mixt.data'</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_mixt_density.html">plot_mixt_density</a></span><span class="op">(</span>samples <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">sample1</span>,<span class="va">sample2</span><span class="op">)</span>, user.bounds<span class="op">=</span><span class="cn">NULL</span>, support<span class="op">=</span><span class="st">'continuous'</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="two_samples_test-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co">##### Performs the test by the different methods :</span></span></span>
<span class="r-in"><span><span class="va">list.comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>f1 <span class="op">=</span> <span class="cn">NULL</span>, g1 <span class="op">=</span> <span class="st">"norm"</span>,</span></span>
<span class="r-in"><span>                  f2 <span class="op">=</span> <span class="cn">NULL</span>, g2 <span class="op">=</span> <span class="st">"norm"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">list.param</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>f1 <span class="op">=</span> <span class="cn">NULL</span>, g1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   f2 <span class="op">=</span> <span class="cn">NULL</span>, g2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">6</span>, sd <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Using expansion coefficients in orthonormal polynomial basis:</span></span></span>
<span class="r-in"><span><span class="fu">two_samples_test</span><span class="op">(</span>samples <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">sample1</span>, <span class="va">sample2</span><span class="op">)</span>, comp.dist<span class="op">=</span><span class="va">list.comp</span>, comp.param<span class="op">=</span><span class="va">list.param</span>,</span></span>
<span class="r-in"><span>                 method <span class="op">=</span> <span class="st">'Poly'</span>, K <span class="op">=</span> <span class="fl">3</span>, support <span class="op">=</span> <span class="st">'Real'</span>, est.method <span class="op">=</span> <span class="st">'BVdk'</span>, s <span class="op">=</span> <span class="fl">0.4</span>,</span></span>
<span class="r-in"><span>                 nb.ssEch <span class="op">=</span> <span class="fl">2</span>, var.explicit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Still needs to be implemented for cases where the unknown density mean is lower then the known density one!</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Still needs to be implemented for cases where the unknown density mean is lower then the known density one!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $rejection_rule</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p_value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8.832881e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $test.stat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 15.3711</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $varCov.matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         [,1]    [,2]     [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1.61746      NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]      NA 46.5912       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]      NA      NA 865.7941</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.769286</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.7490363</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Xavier Milhaud.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

