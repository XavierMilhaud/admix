<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Equality test of unknown component distributions in K admixture models, with IBM approach — IBM_k_samples_test • admix</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Equality test of unknown component distributions in K admixture models, with IBM approach — IBM_k_samples_test" />
<meta property="og:description" content="Test hypothesis on the unknown component of K (K &amp;gt; 1) admixture models using Inversion - Best Matching method.
K-samples test of the unknown component distribution in admixture models using Inversion - Best Matching
(IBM) method. Recall that we have K populations following admixture models, each one with probability
density functions (pdf) l_k = p_k*f_k + (1-p_k)*g_k, where g_k is the known pdf and l_k corresponds to the
observed sample. Perform the following hypothesis test:
H0 : f_1 = ... = f_K  against  H1 : f_i differs from f_j (i diff j, and i,j in 1,...,K)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">admix</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/admixture-clustering.html">Clustering of unknown subpopulations in admixture models</a>
    </li>
    <li>
      <a href="../articles/admixture-weight-estimation.html">Estimation of unknown elements in admixture models</a>
    </li>
    <li>
      <a href="../articles/covid19-pairwise-testing.html">COVID-19 pairwise testing</a>
    </li>
    <li>
      <a href="../articles/test-hypothesis.html">Hypothesis test in admixture models</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/XavierMilhaud/admix/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Equality test of unknown component distributions in K admixture models, with IBM approach</h1>
    <small class="dont-index">Source: <a href='https://github.com/XavierMilhaud/admix/blob/master/R/IBM_k_samples_test.R'><code>R/IBM_k_samples_test.R</code></a></small>
    <div class="hidden name"><code>IBM_k_samples_test.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Test hypothesis on the unknown component of K (K &gt; 1) admixture models using Inversion - Best Matching method.
K-samples test of the unknown component distribution in admixture models using Inversion - Best Matching
(IBM) method. Recall that we have K populations following admixture models, each one with probability
density functions (pdf) l_k = p_k*f_k + (1-p_k)*g_k, where g_k is the known pdf and l_k corresponds to the
observed sample. Perform the following hypothesis test:
H0 : f_1 = ... = f_K  against  H1 : f_i differs from f_j (i diff j, and i,j in 1,...,K).</p>
    </div>

    <pre class="usage"><span class='fu'>IBM_k_samples_test</span><span class='op'>(</span>
  samples <span class='op'>=</span> <span class='cn'>NULL</span>,
  sim_U <span class='op'>=</span> <span class='cn'>NULL</span>,
  n_sim_tab <span class='op'>=</span> <span class='fl'>100</span>,
  min_size <span class='op'>=</span> <span class='cn'>NULL</span>,
  comp.dist <span class='op'>=</span> <span class='cn'>NULL</span>,
  comp.param <span class='op'>=</span> <span class='cn'>NULL</span>,
  parallel <span class='op'>=</span> <span class='cn'>FALSE</span>,
  n_cpu <span class='op'>=</span> <span class='fl'>2</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>samples</th>
      <td><p>A list of the samples to be studied, all following admixture distributions.</p></td>
    </tr>
    <tr>
      <th>sim_U</th>
      <td><p>Random draws of the inner convergence part of the contrast as defined in the IBM approach (see 'Details' below).</p></td>
    </tr>
    <tr>
      <th>n_sim_tab</th>
      <td><p>Number of simulated gaussian processes when tabulating the inner convergence distribution in the IBM approach.</p></td>
    </tr>
    <tr>
      <th>min_size</th>
      <td><p>useful to provide the minimal size among all samples (needed to take into account the correction factor for the
variance-covariance assessment). Otherwise, useless.</p></td>
    </tr>
    <tr>
      <th>comp.dist</th>
      <td><p>A list with 2*K elements corresponding to the component distributions (specified with R native names for these distributions)
involved in the K admixture models. Elements, grouped by 2, refer to the unknown and known components of each admixture model,
If there are unknown elements, they must be specified as 'NULL' objects. For instance, 'comp.dist' could be specified
as follows with K = 3: list(f1 = NULL, g1 = 'norm', f2 = NULL, g2 = 'norm', f3 = NULL, g3 = 'rnorm').</p></td>
    </tr>
    <tr>
      <th>comp.param</th>
      <td><p>A list with 2*K elements corresponding to the parameters of the component distributions, each element being a list
itself. The names used in this list must correspond to the native R argument names for these distributions.
Elements, grouped by 2, refer to the parameters of unknown and known components of each admixture model.
If there are unknown elements, they must be specified as 'NULL' objects. For instance, 'comp.param' could
be specified as follows (with K = 3):
list(f1 = NULL, g1 = list(mean=0,sd=1), f2 = NULL, g2 = list(mean=3,sd=1.1), f3 = NULL, g3 = list(mean=-2,sd=0.6)).</p></td>
    </tr>
    <tr>
      <th>parallel</th>
      <td><p>(default to FALSE) Boolean indicating whether parallel computations are performed (speed-up the tabulation).</p></td>
    </tr>
    <tr>
      <th>n_cpu</th>
      <td><p>(default to 2) Number of cores used when parallelizing.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of ten elements, containing: 1) the rejection decision; 2) the p-value of the test; 3) the terms involved in
the test statistic; 4) the test statistic value; 5) the selected rank (number of terms involved in the test statistic);
6) the value of the penalized test statistic; 7) the sorted contrast values; 8) the 95th-quantile of the contrast
distribution; 9) the final terms of the statistic; and 10) the contrast matrix.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>See the paper presenting the IBM approach at the following HAL weblink: https://hal.archives-ouvertes.fr/hal-03201760</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Xavier Milhaud <a href='mailto:xavier.milhaud.research@gmail.com'>xavier.milhaud.research@gmail.com</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>####### Under the alternative hypothesis H1 (with K=3 populations):</span>
<span class='va'>list.comp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>f1 <span class='op'>=</span> <span class='st'>"norm"</span>, g1 <span class='op'>=</span> <span class='st'>"norm"</span>,
                  f2 <span class='op'>=</span> <span class='st'>"norm"</span>, g2 <span class='op'>=</span> <span class='st'>"norm"</span>,
                  f3 <span class='op'>=</span> <span class='st'>"norm"</span>, g3 <span class='op'>=</span> <span class='st'>"norm"</span><span class='op'>)</span>
<span class='va'>list.param</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>f1 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>mean <span class='op'>=</span> <span class='fl'>0</span>, sd <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>, g1 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>mean <span class='op'>=</span> <span class='fl'>2</span>, sd <span class='op'>=</span> <span class='fl'>0.7</span><span class='op'>)</span>,
                   f2 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>mean <span class='op'>=</span> <span class='fl'>2</span>, sd <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>, g2 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>mean <span class='op'>=</span> <span class='fl'>4</span>, sd <span class='op'>=</span> <span class='fl'>1.1</span><span class='op'>)</span>,
                   f3 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>mean <span class='op'>=</span> <span class='fl'>0</span>, sd <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>, g3 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>mean <span class='op'>=</span> <span class='fl'>3</span>, sd <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>sim1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='rsimmix.html'>rsimmix</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>5000</span>, unknownComp_weight <span class='op'>=</span> <span class='fl'>0.8</span>, comp.dist <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>list.comp</span><span class='op'>$</span><span class='va'>f1</span>,<span class='va'>list.comp</span><span class='op'>$</span><span class='va'>g1</span><span class='op'>)</span>,
                comp.param <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>list.param</span><span class='op'>$</span><span class='va'>f1</span>, <span class='va'>list.param</span><span class='op'>$</span><span class='va'>g1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>$</span><span class='va'>mixt.data</span>
<span class='va'>sim2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='rsimmix.html'>rsimmix</a></span><span class='op'>(</span>n<span class='op'>=</span> <span class='fl'>5300</span>, unknownComp_weight <span class='op'>=</span> <span class='fl'>0.6</span>, comp.dist <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>list.comp</span><span class='op'>$</span><span class='va'>f2</span>,<span class='va'>list.comp</span><span class='op'>$</span><span class='va'>g2</span><span class='op'>)</span>,
                comp.param <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>list.param</span><span class='op'>$</span><span class='va'>f2</span>, <span class='va'>list.param</span><span class='op'>$</span><span class='va'>g2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>$</span><span class='va'>mixt.data</span>
<span class='va'>sim3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='rsimmix.html'>rsimmix</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>5100</span>, unknownComp_weight <span class='op'>=</span> <span class='fl'>0.7</span>, comp.dist <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>list.comp</span><span class='op'>$</span><span class='va'>f3</span>,<span class='va'>list.comp</span><span class='op'>$</span><span class='va'>g3</span><span class='op'>)</span>,
                comp.param <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>list.param</span><span class='op'>$</span><span class='va'>f3</span>, <span class='va'>list.param</span><span class='op'>$</span><span class='va'>g3</span><span class='op'>)</span><span class='op'>)</span><span class='op'>$</span><span class='va'>mixt.data</span>
<span class='co'>## Perform the 3-samples test in a real-life setting:</span>
<span class='va'>list.comp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>f1 <span class='op'>=</span> <span class='cn'>NULL</span>, g1 <span class='op'>=</span> <span class='st'>"norm"</span>,
                  f2 <span class='op'>=</span> <span class='cn'>NULL</span>, g2 <span class='op'>=</span> <span class='st'>"norm"</span>,
                  f3 <span class='op'>=</span> <span class='cn'>NULL</span>, g3 <span class='op'>=</span> <span class='st'>"norm"</span><span class='op'>)</span>
<span class='va'>list.param</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>f1 <span class='op'>=</span> <span class='cn'>NULL</span>, g1 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>mean <span class='op'>=</span> <span class='fl'>2</span>, sd <span class='op'>=</span> <span class='fl'>0.7</span><span class='op'>)</span>,
                   f2 <span class='op'>=</span> <span class='cn'>NULL</span>, g2 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>mean <span class='op'>=</span> <span class='fl'>4</span>, sd <span class='op'>=</span> <span class='fl'>1.1</span><span class='op'>)</span>,
                   f3 <span class='op'>=</span> <span class='cn'>NULL</span>, g3 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>mean <span class='op'>=</span> <span class='fl'>3</span>, sd <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>obj</span> <span class='op'>&lt;-</span> <span class='fu'>IBM_k_samples_test</span><span class='op'>(</span>samples<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>sim1</span>,<span class='va'>sim2</span>,<span class='va'>sim3</span><span class='op'>)</span>, sim_U<span class='op'>=</span><span class='cn'>NULL</span>, n_sim_tab<span class='op'>=</span><span class='fl'>8</span>, min_size<span class='op'>=</span><span class='cn'>NULL</span>,
                          comp.dist<span class='op'>=</span><span class='va'>list.comp</span>, comp.param<span class='op'>=</span><span class='va'>list.param</span>, parallel<span class='op'>=</span><span class='cn'>TRUE</span>, n_cpu<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: In 'IBM_estimProp': optimization algorithm was changed (in 'optim') from 'Nelder-Mead' to 'BFGS' to avoid the solution to explose.</span></div><div class='input'><span class='va'>obj</span><span class='op'>$</span><span class='va'>rejection_rule</span>
</div><div class='output co'>#&gt;  95% 
#&gt; TRUE </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Xavier Milhaud.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


